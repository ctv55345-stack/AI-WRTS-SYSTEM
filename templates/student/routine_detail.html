<!DOCTYPE html>
<html>
<head>
    <title>Chi tiết bài võ</title>
</head>
<body>
    <h1>CHI TIẾT BÀI VÕ</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div><strong>[{{ category|upper }}]</strong> {{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <table>
        <tr><td>Tên bài võ</td><td><strong>{{ routine.routine_name }}</strong></td></tr>
        <tr><td>Mã bài võ</td><td>{{ routine.routine_code }}</td></tr>
        <tr><td>Mô tả</td><td>{{ routine.description or 'Không có' }}</td></tr>
        <tr><td>Binh khí</td><td>{{ routine.weapon.weapon_name_vi }} ({{ routine.weapon.weapon_name_en }})</td></tr>
        <tr>
            <td>Cấp độ</td>
            <td>{% if routine.level == 'beginner' %}Sơ cấp{% elif routine.level == 'intermediate' %}Trung cấp{% elif routine.level == 'advanced' %}Nâng cao{% endif %}</td>
        </tr>
        <tr><td>Độ khó</td><td>{{ routine.difficulty_score }}/10</td></tr>
        <tr><td>Thời lượng</td><td>{{ (routine.duration_seconds / 60)|round(1) }} phút ({{ routine.duration_seconds }} giây)</td></tr>
        <tr><td>Số động tác</td><td>{{ routine.total_moves }}</td></tr>
        <tr><td>Ngưỡng đạt</td><td>{{ routine.pass_threshold }}%</td></tr>
        <tr><td>Giảng viên</td><td>{{ routine.creator.full_name }}</td></tr>
    </table>

    {% if routine.reference_video_url %}
    <div>
        <h3>VIDEO MẪU CHUẨN</h3>
        <p><a href="{{ routine.reference_video_url }}" target="_blank">Xem video mẫu</a></p>
        <p><small>Lưu ý: Xem kỹ video mẫu trước khi tập luyện và quay video của bạn</small></p>
    </div>
    {% else %}
    <p>Bài võ này chưa có video mẫu chuẩn</p>
    {% endif %}

    {% if criteria %}
    <h2>TIÊU CHÍ ĐÁNH GIÁ</h2>
    <p>Bài của bạn sẽ được đánh giá theo các tiêu chí sau:</p>
    {% for c in criteria %}
    <div>
        <strong>{{ c.criteria_name }}</strong> - <strong>{{ c.weight_percentage }}%</strong>
        {% if c.description %}<br><small>{{ c.description }}</small>{% endif %}
    </div>
    {% endfor %}
    {% endif %}

    <hr>
    <p>
        <a href="{{ url_for('student.routines') }}">Quay lại</a>
        <a href="{{ url_for('student.dashboard') }}">Dashboard</a>
    </p>
</body>
</html>

